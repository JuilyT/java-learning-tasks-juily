package org.Refactoring;

import java.util.Iterator;

public class EmailPrintStatement implements PrintStatement{
	private Customer customer;

	public EmailPrintStatement(Customer customer) {
		this.customer = customer;
	}

	public String fetchStatement() throws Exception {
		Iterator<Rental> iterator = customer.getRentals().iterator();
		double price = 0.0;
		int frequentRenterPoints = 0;
		while (iterator.hasNext()) {
			Rental rental = iterator.next();
			rental.setBook(BookFactory.getBook(rental.getBook().getBookCategory()));
			price += rental.getBook().getPrice(rental.getDaysRented());
			frequentRenterPoints = rental.addPoints();
		}
		return new StringBuilder().append("Email Statement: ").append(price).toString();
	}
	Rental rental = (Rental) rentalsItr.next();
	rental.setBook(BookFactory.getBook(rental.getBook().getBookCategory()));
	// determine amounts for each book.
	thisAmount = rental.getPrice();			
	// show figures for this rental
	result.append("\t").append(rental.getBook().getTitle()).append("\t").append(String.valueOf(thisAmount))
			.append("\n");
	totalAmount += thisAmount;
	frequentRenterPoints = rental.addPoints();
}
